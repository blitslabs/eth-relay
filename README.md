# Idena ETH Relay

Idena-ETH-Relay is used to make the validated cryptoidentities be relayed from the [Idena Blockchain](https://idena.io/) to [Ethereum Blockchain](https://ethereum.org/).

The idea of this project came from [Gitcoin Hackathon: GitxChange](https://gitcoin.co/issue/idena-network/idena-go/426/4357), and this 1st solution was based on the "Possible Implementation" advice from idena official.

## Solution

This solution uses a relay smart contract to maintain validated cryptoidentities in ethereum blockchain from idena blockchain.

The inititial state of the smart contract need to be set after deploying by the owner (probably the idena official team), however, they can only do this once.
After the initialization, anyone who can provide the crypto-valid state transition can send an ethereum transactin to change the contract's state.

A crypto-valid state transition requires the previouse state, the new validated identities added, the old validated identities deleted, and the signatures of old validated participants confirming correctness of this transition.
These data of crypto-valid state transitions will be publicly available in the idena blockchain when the validated identity set changed (new epoch applied, kill identity, kill invitee).

This will make the relay contract maintain the up-to-date set of validated identities from idena blockchain without any trusted oracle(s) or organization(s).

We use the [BLS(Barreto Lynn Scott)](https://www.iacr.org/archive/asiacrypt2001/22480516.pdf) signature scheme instead of the ECDSA (secp256k1) used by both ETH1 and idena to have smaller inputs and consuming less gas.
Because quorum signatures are required for each contract state updating, and the BLS signature have suitable features like key aggregatation and multi-signature.

The whole solution is mainly composed of two parts:
1. [The relay smart contract](https://github.com/idena-lab/eth-relay)
2. [The improved idena node](https://github.com/idena-lab/idena-go)

### The Relay Smart Contract

The relay smart contract is responsible for maintaining addresses and BLS keys of all validated cryptoidentities from idena blockchain.

The address represents the validated identity in idena, the format is same as the ethereum address since both idena and eth use the same address rule.

The keys are BLS(Barreto Lynn Scott) public keys generated by [the improved idena node](https://github.com/idena-lab/idena-go) with alt-bn128 curve.

The [test-results](https://github.com/idena-lab/eth-relay/blob/master/test-results.md) records some outputs of test cases, including some examples of simulating state initialization and transitions. The test cases will also show gas costs of the transactions.

### The Improved Idena Node

Todo: It is still in the process of basic function development, will be open sourced and explained later.

## Improvements

* Make the relay contract to consume lower amount of gas.
* Split the `init()` and `update()` function to support multi-transactions calling.
  - Because an tranasaction may need more gas than the block gas limit if there are to identities to add.
* Adopt the BLS12-381 instead of bls with alt-bn128 after the hard-fork of ethereum blockchain with BLS12-381 support.
  - [EIP 2537: Precompile for BLS12-381 curve operations](https://eips.ethereum.org/EIPS/eip-2537)
  - [EIP 1962: EC arithmetic and pairings with runtime definitions](https://eips.ethereum.org/EIPS/eip-1962)

## Other Solutions

Idena ethereum relay is [a wonderful idea](https://gitcoin.co/issue/idena-network/idena-go/426/4357), and the solution adopted now is not perfect.

For example, the following directions are worthy of consideration and attention:
* Use [Zero-Knowledge Proofs](https://zkp.science) like zk-snarks or others to prove the correctness of transition.
* Adopt the BLS threshold signature (subgroup multisignature scheme, m-of-n multisig), which will make the verification more concise and efficient.

Any other solutions, ideas and suggestions are welcome.

## Tools and Apps

[bls-256-go](https://github.com/idena-lab/bls-256-go) implements the iniial version of bls-256 signature used by the relay.
It also provides code (in test) to generate test data for the relay contract.

More tools and apps are expected to be developed to make the relay work better and easier.
Such as the following tools (not limited to)
* A robot like program to monitor the idena blockchain and send 
* A frontend of the relay contract to show contract state more intuitively.
* DApps on the ethereum blockchain to integrated the validated cryptoidentities from idena.
